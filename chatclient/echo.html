<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<body>
    
    <!-- 리액트 프로그램이 렌더링 될 영역 -->
    <div id="app"></div>




    <!-- text/babel을 명시해야 함수 안 태그에 대해 당황하지 않는다. -->
    <script type="text/babel">
        // 부모인 루트 컴포넌트 정의
        function App(){
            // 컴포넌트 내에서 바인딩 목적이 아닌, 즉 렌더링과 무관하지만 컴포넌트의 생명주기 동안 유지되어야 하는
            // 값은(저장공간) useRef를 이용한다. 전역변수처럼 ws를 사용하지 마라.
            const wsRef = React.useRef(null);     //wsRef는 이 시점부터 ref 객체가 되며, 실제 데이터는 ref 안에 current Property에 담아야 한다.

            function connect(){
                // 2011년도에 표준화되었기 때문에 표준을 준수하는 모든 브라우저는 웹소켓을 보유하고 있다
                //new WebSocket("ws://스프링서버주소");
                const ws = new WebSocket("ws://localhost:9991/ws/echo");
                wsRef.current = ws;
            }

            function disconnect(){
                wsRef.current.close();  // 접속 끊기
            }

            return (
                <div id="wrapper">
                    <h2>WebSocket Echo Client</h2>

                    <div>
                        <b>Status: </b>
                    </div>

                    <div>
                        <button onClick={connect}>Connect</button>
                        <button onClick={disconnect}>Disconnect</button>
                    </div>

                    <div>
                        <input type="text" placeholder="message input"/>
                    </div>

                    <div>
                        <h4>Received Message</h4>
                        <ul>
                            <li>Incoming message output</li>
                        </ul>
                    </div>
                </div>
            )
        }

        const root = ReactDOM.createRoot(document.getElementById("app"));
        root.render(<App />);
    </script>

</body>
</html>